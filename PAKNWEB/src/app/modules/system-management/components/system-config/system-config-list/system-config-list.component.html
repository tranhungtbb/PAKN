
<div class="panel-group">
  <section class="content">
    <div class="row">
      <ol class="breadcrumb">
        <li>
          <a class="text-black" routerLink="/business/business-management/dash-board">Trang chủ</a>
        </li>
        <li>
          <a class="text-black">Hệ thống</a>
        </li>
        <li>
          <a>Cấu hình hệ thống</a>
        </li>
      </ol>
      <button class="btn btn-sm btn-previous pull-right" appSvBackButton><i class="far fa-undo-alt"></i> Quay lại</button>
    </div>
    <div class="col-xs-12 no-padding">
      <div class="panel panel-default">
        <div class="panel-heading">
          <div class="row">
            <div class="col-md-offset-6 col-md-6 panel-heading-group">
              <div class="form-row">
                <div class="search-item">
                  <input class="form-control" [(ngModel)]="maCauhinh" (keydown.enter)="dataStateChange()" type="text" maxlength="50" placeholder="Nhập mã cấu hình..." />
                </div>
                <div class="search-item">
                  <input class="form-control" [(ngModel)]="tencauhinh" (keydown.enter)="dataStateChange()" type="text" maxlength="255" placeholder="Nhập tên cấu hình..." />
                </div>
                <div>
                  <button class="btn btn-primary btn-sm" (click)="dataStateChange()">
                    <i class="fal fa-search"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <p-table [value]="systemConfiglst" [lazy]="true" (onLazyLoad)="onPageChange($event)" [paginator]="true" [rows]="pagesize" [totalRecords]="totalRecords" [rowsPerPageOptions]="[10,20,30]" [responsive]="true" autoLayout="true" [showCurrentPageReport]="true" currentPageReportTemplate="Tổng số {{totalRecords}}">
          <ng-template pTemplate="header">
            <tr>
              <th style="width: 50px">
                STT
              </th>
              <th style="width: 17%">
                Mã
              </th>
              <th>
                Tên cấu hình
              </th>
              <th style="width: 20%">
                Giá trị
              </th>
              <th style="width: 120px">Hành động</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-rowIndex="rowIndex" let-sysconfig>
            <tr>
              <td class="text-center">{{rowIndex + 1}}</td>
              <td class="text-center">
                <a (click)="getdata(sysconfig.id)" title="Xem chi tiết">{{sysconfig.code}}</a>
              </td>
              <td>{{sysconfig.tenCauHinh}}</td>
              <td class="text-right">{{sysconfig.giaTri}}</td>
              <td class="text-center">
                <a *hasPermission="['3', 'A_I_1']" title="Sửa" data-id="sysconfig.id" (click)="passingData(sysconfig.id)"><i class="far fa-pen"></i></a>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="5">
                Không tìm thấy dữ liệu
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>
  </section>
</div>

<div class="modal fade in" id="editSystemConfigModal">
  <div class="modal-dialog" style="min-width: 50%">
    <div class="panel panel-default">
      <div class="panel-heading">
        <button class="close btn-close-modal" data-dismiss="modal">
          ×
        </button>
        <p class="modal-title">Thông tin cấu hình</p>
      </div>
      <div class="panel-body">
        <form id="systemConfigForm" [formGroup]="systemConfigForm" #formDir="ngForm" (ngSubmit)="onSave()">
          <div class="row form-group">
            <div class="col-sm-6">
              <label>Mã cấu hình <span class="text-danger">*</span></label>
              <input class="form-control" formControlName="code" [(ngModel)]="model.code" maxlength="100" readonly />
              <div *ngIf="(submitted && f.code.invalid)||(f.code.invalid && (f.code.dirty || f.code.touched))" class="has-error m-b-12">
                <div *ngIf="f.code.errors.required">
                  <span class="help-block">Trường dữ liệu này không được để trống</span>
                </div>
              </div>
            </div>
            <div class="col-sm-6">
              <label>Trạng thái <span class="text-danger">*</span></label>
              <ng-select [items]="listTrangThai"
                         bindValue="value"
                         bindLabel="text"
                         formControlName="trangThai"
                         [(ngModel)]="model.trangThai">
              </ng-select>
              <div *ngIf="(submitted && f.trangThai.invalid)||(f.trangThai.invalid && (f.trangThai.dirty || f.trangThai.touched))" class="has-error m-b-12">
                <div *ngIf="f.trangThai.errors.required">
                  <span class="help-block">Trường dữ liệu này không được để trống</span>
                </div>
              </div>
            </div>
          </div>
          <div class="row form-group">
            <div class="col-sm-6">
              <label>Tên cấu hình <span class="text-danger">*</span></label>
              <input class="form-control" formControlName="tenCauHinh" [(ngModel)]="model.tenCauHinh" maxlength="100" />
              <div *ngIf="(submitted && f.tenCauHinh.invalid)||(f.tenCauHinh.invalid && (f.tenCauHinh.dirty || f.tenCauHinh.touched))" class="has-error m-b-12">
                <div *ngIf="f.tenCauHinh.errors.required">
                  <span class="help-block">Trường dữ liệu này không được để trống</span>
                </div>
              </div>
            </div>
            <div class="col-sm-6">
              <label>Giá trị</label>
              <input class="form-control" formControlName="giaTri" [(ngModel)]="model.giaTri" maxlength="100" min="0" type="number" />
            </div>
          </div>
          <div class="row form-group">
            <div class="col-sm-12">
              <label>Mô tả</label>
              <textarea rows="4" class="form-control" formControlName="moTa" [(ngModel)]="model.moTa" maxlength="255"></textarea>
            </div>
          </div>
        </form>
      </div>
      <div class="panel-footer">
        <div class="row">
          <div class="col-sm-12 text-right">
            <button type="button" class="btn btn-save btn-sm m-l-5" (click)="onSave()" style="margin-right:10px">
              <i class="fal fa-save"></i> Lưu
            </button>
            <button type="button" class="btn btn-default btn-sm" data-dismiss="modal">
              <i class="far fa-times"></i> Hủy
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade in" id="viewSystemConfigModal" tabindex="-1" *hasPermission="['3', 'A_I_2']">
  <div class="modal-dialog" style="min-width: 50%">
    <div class="panel panel-default">
      <div class="panel-heading">
        <button class="close btn-close-modal" data-dismiss="modal">
          ×
        </button>
        <p class="title-ct no-margin">Thông tin cấu hình</p>
      </div>
      <div class="panel-body">
        <form id="viewsystemConfigForm" [formGroup]="viewsystemConfigForm" #formDir="ngForm">
          <div class="row">
            <div class="col-sm-6">
              <label class="lb600">Mã cấu hình</label>
              <p>{{model.code}}</p>
            </div>
            <div class="col-sm-6">
              <label class="lb600">Trạng thái</label>
              <p *ngIf="model.trangThai == true">Hiệu lực</p>
              <p *ngIf="model.trangThai == false">Hết hiệu lực</p>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-6">
              <label class="lb600">Tên cấu hình</label>
              <p>{{model.tenCauHinh}}</p>
            </div>
            <div class="col-sm-6">
              <label class="lb600">Giá trị</label>
              <p>{{model.giaTri}}</p>
            </div>
          </div>
          <div class="row">
            <div class="col-sm-12">
              <label class="lb600">Mô tả</label>
              <p>{{model.moTa}}</p>
            </div>
          </div>
        </form>
      </div>
      <div class="panel-footer">
        <div class="row">
          <div class="col-sm-12">
            <button type="button" class="btn btn-default btn-sm pull-right" data-dismiss="modal"><i class="far fa-times"></i> Hủy</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

