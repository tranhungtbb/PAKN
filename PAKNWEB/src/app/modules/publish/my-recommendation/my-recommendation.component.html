<div class="content-nd">
	<div class="container">
		<div class="row justify-content-between margin-top-16">
			<div class="col-12 col-lg-auto d-none d-lg-block sidebar-ct">
				<div class="media pt-3 mb-3">
					<div class="avatar-circle bg-light mr-2">
						<a [routerLink]="['/cong-bo/tai-khoan/thong-tin']">
							<i class="bi bi-person-fill text-dark" style="font-size: 24px"></i>
						</a>

					</div>
					<div class="media-body">
						<p class="my-0 font-weight-bolder h4" [routerLink]="['/cong-bo/tai-khoan/thong-tin']">{{userName}}</p>
						<p class="mb-0 small">Tên đăng nhập: {{modelUser.userName}}</p>
					</div>
				</div>
				<ul class="nav nav-qltknd flex-column">
					<li class="nav-item border-bottom">
						<a class="nav-link px-0 h5 p-title-hover" [routerLink]="['/cong-bo/tai-khoan/thong-tin']"
							aria-current="page">Thông tin
							tài khoản</a>
					</li>
					<li class="nav-item border-bottom">
						<a class="nav-link px-0 h5 p-title-hover" [routerLink]="['/cong-bo/tai-khoan/thay-doi-mat-khau']">Đổi mật
							khẩu</a>
					</li>
					<li class="nav-item">
						<a class="nav-link px-0 h5 p-title-hover" (click)="preSignOut()">Đăng xuất</a>
					</li>
				</ul>

				<div class="sb-tk-pakn mb-4 card-my-recommentdation"
					*ngIf="typeUserLoginPublish != 1 && recommendationStatistics">
					<div class="tt-v1 pt-3 pb-3 d-flex justify-content-center" (click)="redirectMyRecommendaton(0)">
						<h4 class="text-uppercase">Phản ánh, kiến nghị của tôi</h4>
						<!-- <h4 class="counter cursor" style="padding-right: 14px;">{{totalRecommentdation}}</h4> -->
					</div>
					<div>
						<div class="border-left-yellow mb-3 d-flex justify-content-between center"
							(click)="redirectMyRecommendaton(1)">
							<div class="pf-4 pointer">
								<p class="title-status-rm ml-3 mb-0">Chờ tiếp nhận</p>
							</div>
							<div class="circle bg-yellow center text-white cursor">
								{{recommendationStatistics.receiveWait}}
							</div>
						</div>
						<div class="border-left-blue2 mb-3 d-flex justify-content-between center"
							(click)="redirectMyRecommendaton(2)">
							<div class="pf-4 pointer">
								<p class="title-status-rm ml-3 mb-0">Đã tiếp nhận</p>
							</div>
							<div class="circle bg-blue2 center text-white cursor">
								{{recommendationStatistics.receiveApproved}}
							</div>
						</div>
						<div class="border-left-blue3 mb-3 d-flex justify-content-between center"
							(click)="redirectMyRecommendaton(3)">
							<div class="pf-4 pointer">
								<p class="title-status-rm ml-3 mb-0">Đang giải quyết</p>
							</div>
							<div class="circle bg-blue3 center text-white cursor">
								{{recommendationStatistics.processing}}
							</div>
						</div>
						<div class="border-left-blue mb-3 d-flex justify-content-between center"
							(click)="redirectMyRecommendaton(4)">
							<div class="pf-4 pointer">
								<p class="title-status-rm ml-3 mb-0">Đã giải quyết</p>
							</div>
							<div class="circle bg-blue center text-white cursor">
								{{recommendationStatistics.finised}}
							</div>
						</div>
						<div class="border-left-red mb-3 d-flex justify-content-between center"
							(click)="redirectMyRecommendaton(5)">
							<div class="pf-4 pointer">
								<p class="title-status-rm ml-3 mb-0">Bị từ chối</p>
							</div>
							<div class="circle bg-red center text-white cursor">
								{{recommendationStatistics.approve}}
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col main-ct pl-3 pl-lg-4">
				<div class="row mb-3">
					<div class="col-md-12 col-lg-12">
						<div class="tt-v1 mb-3">
							<div class="">
								<div class="row pi-italic center">
									<div class="col-lg-4">
										<h4 class="text-uppercase mb-0">Phản ánh, kiến nghị của tôi</h4>
									</div>

									<div class="col-lg-7 p-0 pr-2 p-xs-0 pi-italic">
										<input placeholder="Nhập từ khóa.." class="form-control form-control border-radius-4"
											(keyup)="changeKeySearch($event)" [(ngModel)]="title" (keydown.enter)="getList()"
											maxlength="100" />
									</div>

									<div class="col-lg-1 px-2 p-xs-0">
										<button type="button" class="btn text-white border-0 no-grd-blue border-radius-4 h-38px center"
											style="text-transform: none;" (click)="dataStateChange()">
											<!-- Tìm kiếm -->
											<i class="bi bi-search"></i>
										</button>
									</div>
								</div>
							</div>
						</div>

					</div>
				</div>

				<ng-container *ngFor="let item of listData;let i = index">
					<div class="card card-custom mb-0 border-bottom" [ngClass]="{'bg-gray' : i % 2 != 0}">
						<div class="card-header pt-2 px-2 pb-0 align-items-center">
							<p class="card-text mb-1 ">
								<a class="h4 text-2line p-title-hover mb-0" routerLink="/cong-bo/chi-tiet-kien-nghi/{{item.id}}">
									{{item.title}}
								</a>
							</p>
						</div>
						<div class="card-body px-2 py-1">
							<p class="card-text">
								<a class="text-2line mb-0 p-title-hover"
									[routerLink]="['/cong-bo/chi-tiet-kien-nghi/',item.id]">{{item.content}}</a>
							</p>
						</div>
						<div class="card-footer pt-0 px-2 border-top-0 d-flex justify-content-between align-items-center">
							<span>
								<i class="bi bi-alarm cl-gray mt-1 mr-2 p-item-title "></i>
								<span>{{item.createdDate | date:'dd/MM/yyyy HH:mm'}}</span>
							</span>

							<div class="col-md-6">
								<div class="d-flex justify-content-end">
									<a [routerLink]="['/cong-bo/cap-nhat-kien-nghi/',item.id]" *ngIf="item.status == 1"
										class="btn-icon grd-brown text-brown mr-2" title="Cập nhật"><i class="bi bi-pencil-square"></i></a>
									<a *ngIf="item.status == 1" class="btn-icon grd-blue text-white mr-2 .pointer" title="Gửi"
										(click)="preSend(item.id)">
										<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
											<path
												d="M13.5938 0.125927L0.468823 7.69624C-0.205005 8.08589 -0.137622 9.07905 0.580151 9.37495L4.68757 11.0742V14.0625C4.68757 14.9472 5.795 15.331 6.34871 14.6572L8.12703 12.4951L11.8302 14.0244C12.3897 14.2558 13.0225 13.9013 13.1134 13.3007L14.9884 1.081C15.1085 0.298778 14.2677 -0.263722 13.5938 0.125927ZM5.62507 14.0625V11.4609L7.22175 12.1201L5.62507 14.0625ZM12.1876 13.1572L6.14656 10.6611L11.9913 3.75288C12.1319 3.58882 11.9063 3.36616 11.7423 3.50679L4.26277 9.88179L0.937573 8.51069L14.0626 0.93745L12.1876 13.1572Z"
												fill="white"></path>
										</svg>
									</a>
									<a *ngIf="item.status == 1" class="btn-icon grd-red text-white mr-2 .pointer"
										(click)="preDelete(item.id)" title="Xóa"><i class="bi bi-trash"></i></a>
									<span *ngIf="item.status == 2 || (item.status == 5 && item.isForwardProcess)"
										class="badge rounded-pill badge-outline-dark">Chờ tiếp nhận</span>
									<span *ngIf="item.status == 4" class="badge rounded-pill bg-blue-light">Đã tiếp nhận</span>
									<span
										*ngIf="item.status == 7  || item.status == 8 || item.status == 9 || (item.status == 5 && !item.isForwardProcess)"
										class="badge rounded-pill bg-blue3 ng-star-inserted">Đang giải quyết</span>
									<span *ngIf="item.status == 3 || item.status == 6" class="badge rounded-pill bg-red">Bị từ
										chối</span>
									<span *ngIf="item.status == 10" class="badge rounded-pill" style="background-color:forestgreen ;">Đã
										trả
										lời</span>

								</div>
							</div>
						</div>
					</div>
				</ng-container>

				<!-- <nav aria-label="navigation" *ngIf="listData.length > 0">
					<ul class="pagination pagination-lg justify-content-between align-items-center">
						<li class="page-item" [ngClass]="{ 'disabled': pageIndex == 1 }">
							<a (click)="changePagination(pageIndex - 1)" class="page-link border text-uppercase rounded-pill p-3"
								href="javascript:void(0)" tabindex="-1" aria-disabled="true">&nbsp;&nbsp;<i
									class="bi bi-chevron-left"></i>&nbsp;Trước</a>&nbsp;&nbsp;
						</li>
						<li class="d-flex justify-content-center align-items-center">
							<a *ngIf="pageIndex > 4">...</a>
							<p class="mb-0 page-item" *ngFor="let item of pagination; let i = index"
								[ngClass]="{ 'active': item.index === pageIndex }">
								<a (click)="changePagination(item.index)" *ngIf="i - 3 < pageIndex && i + 5 > pageIndex"
									class="page-link" href="javascript:void(0)">{{item.index}}</a>
							</p>
							<a *ngIf="pageIndex < pagination.length -4">..</a>
						</li>
						<li class="page-item" [ngClass]="{ 'disabled': pageIndex == totalRecords }">
							<a (click)="changePagination(pageIndex + 1)" class="page-link border text-uppercase rounded-pill p-3"
								href="javascript:void(0)">
								&nbsp;&nbsp;&nbsp;&nbsp;Sau&nbsp;<i class="bi bi-chevron-right"></i>&nbsp;&nbsp;&nbsp;&nbsp;
							</a>
						</li>
					</ul>
				</nav> -->

				<nav aria-label="navigation" class="pagination-xs mt-4 ps-relative">
					<span class="justify-content-start align-items-center ps-absolute">
						<strong>Tổng số: {{totalRecords}}</strong> <span class="ml-2">phản ánh, kiến nghị</span>
					</span>
					<ul class="pagination pagination-lg justify-content-end align-items-center">
						<li class="page-item center cursor" [ngClass]="{ 'disabled':pageIndex == 1 }">
							<a (click)="changePagination(pageIndex - 1)" class="page-link border rounded-pill p-1 pr-3" tabindex="-1"
								aria-disabled="true">&nbsp;&nbsp;<i class="bi bi-chevron-left"></i>&nbsp;Trước</a>&nbsp;&nbsp;
						</li>
						<li class="d-flex justify-content-center align-items-center">
							<a *ngIf="pageIndex > 4" class="cursor">...</a>
							<p class="mb-0 page-item cursor" *ngFor="let item of pagination; let i = index"
								[ngClass]="{ 'active': item.index ===pageIndex }">
								<a (click)="changePagination(item.index)" *ngIf="i - 3 < pageIndex && i + 5 >pageIndex"
									class="page-link">{{item.index}}</a>
							</p>
							<a *ngIf="pageIndex < pagination.length -4" class="mr-2 cursor">...</a>
						</li>
						<li class="page-item center cursor" [ngClass]="{ 'disabled':pageIndex == Total }">
							<a (click)="changePagination(pageIndex + 1)" class="page-link border rounded-pill p-1">
								&nbsp;&nbsp;&nbsp;&nbsp;Sau&nbsp;<i class="bi bi-chevron-right"></i>&nbsp;&nbsp;&nbsp;&nbsp;
							</a>
						</li>
					</ul>
				</nav>

				<div *ngIf="listData.length == 0" class="text-center">
					<span>Không có phản ánh, kiến nghị nào</span>
				</div>
			</div>
		</div>
	</div>
</div>


<div class="modal fade" id="modalConfirmDelete">
	<div class="modal-dialog modal-dialog-centered modal-md" style="min-width: 500px" role="document">
		<div class="modal-content rounded">
			<div class="modal-header border-bottom-0">
				<p class="modal-title h3">Xác nhận</p>
				<button type="button" (click)="closeModalDelete()" class="close" data-dismiss="modal"><span>&times;</span>
				</button>
			</div>
			<div class="modal-body pb-3 pt-3">
				<span>
					Anh/Chị có chắc chắn muốn xóa Phản ánh, Kiến nghị này?
				</span>
			</div>
			<div class="modal-footer border-top-0">
				<button type="button" class="btn btn-outline-secondary btn-sm border px-5" (click)="closeModalDelete()"
					data-dismiss="modal">Hủy</button>
				<button type="button" class="btn btn-danger border-0 px-5 grd-blue btn-sm"
					(click)="onDelete(recommandationId)">Xác nhận</button>
			</div>
		</div>
	</div>
</div>


<div class="modal fade" id="modalConfirmSend">
	<div class="modal-dialog modal-dialog-centered modal-md" style="min-width: 500px" role="document">
		<div class="modal-content rounded">
			<div class="modal-header border-bottom-0">
				<p class="modal-title h3">Xác nhận</p>
				<button type="button" (click)="closeModalSend()" class="close" data-dismiss="modal"><span>&times;</span>
				</button>
			</div>
			<div class="modal-body pb-3 pt-3">
				<span>
					Anh/Chị có chắc chắn muốn gửi Phản ánh, Kiến nghị này?
				</span>
			</div>
			<div class="modal-footer border-top-0">
				<button type="button" class="btn btn-outline-secondary btn-sm border px-5" (click)="closeModalSend()"
					data-dismiss="modal">Hủy</button>
				<button type="button" class="btn btn-danger border-0 px-5 grd-blue btn-sm" (click)="onSend(5)">Xác nhận</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="acceptSignOut">
	<div class="modal-dialog modal-dialog-centered modal-md" style="min-width: 500px" role="document">
		<div class="modal-content rounded">
			<div class="modal-header border-bottom-0">
				<p class="modal-title h3">Xác nhận</p>
				<button type="button" (click)="closeModal()" class="close" data-dismiss="modal"><span>&times;</span>
				</button>
			</div>
			<div class="modal-body pb-3 pt-3">
				<span>
					Anh/Chị có chắc chắn muốn đăng xuất?
				</span>
			</div>
			<div class="modal-footer border-top-0">
				<button type="button" class="btn btn-outline-secondary btn-sm border px-5" (click)="closeModal()"
					data-dismiss="modal">Hủy</button>
				<button type="button" class="btn btn-danger border-0 px-5 grd-blue btn-sm" (click)="mySignOut()">Xác
					nhận</button>
			</div>
		</div>
	</div>
</div>