<div class="content-body">
	<div class="container-fluid p-0">
		<div class="row">
			<div class="col-lg-12">
				<ol class="breadcrumb title-module px-0 bg-transparent mb-0">
					<li class="breadcrumb-item"><a>Phản ánh, Kiến nghị</a></li>
					<li class="breadcrumb-item active"><a class="font-weight-bold">Bình luận Phản ánh, Kiến nghị</a></li>
				</ol>
				<div class="btn-group group-button-table" role="group">
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-lg-12">
				<div class="card mb-0 shadow-none">
					<div class="table-responsive">
						<p-treeTable #table [value]="listData" (onNodeExpand)="onNodeExpand($event)" [paginator]="true"
							[totalRecords]="totalRecords" [rows]="pageSize" [rowsPerPageOptions]="[20,30,50]" autoLayout="true"
							(onLazyLoad)="onPageChange($event)" [lazy]="true"
							tableStyleClass="table table-sd table-responsive-md table-striped mb-0">
							<ng-template pTemplate="header" class="bg-thead">
								<tr>
									<th style="width: 50px;">
										<p class="mb-1 d-flex justify-content-between align-items-center label-thead">
											<strong>STT</strong>
										</p>
									</th>

									<th style="width: 210px">
										<p class="mb-1 d-flex justify-content-between align-items-center label-thead">
											<strong>Người tạo</strong>
										</p>
										<input placeholder="Nhập.." class="form-control form-control-sm" [(ngModel)]="dataSearch.fullName"
											maxlength="100" (keydown.enter)="dataStateChange()" />
										<button *ngIf="dataSearch.fullName" class="btn bg-transparent btn-clear-input"
											(click)="dataSearch.fullName=''">
											<i class="fa fa-times"></i>
										</button>
									</th>

									<th>
										<p class="mb-1 d-flex justify-content-between align-items-center label-thead">
											<strong>Nội dung bình luận</strong>
										</p>
										<input placeholder="Nhập.." class="form-control form-control-sm" [(ngModel)]="dataSearch.contents"
											maxlength="100" (keydown.enter)="dataStateChange()" />
										<button *ngIf="dataSearch.contents" class="btn bg-transparent btn-clear-input"
											(click)="dataSearch.contents=''">
											<i class="fa fa-times"></i>
										</button>
									</th>

									<th style="width: 200px;">
										<p class="mb-1 d-flex justify-content-between align-items-center label-thead">
											<strong>Tiêu đề</strong>

										</p>
										<input placeholder="Nhập.." class="form-control form-control-sm"
											[(ngModel)]="dataSearch.titleRecommendation" maxlength="100"
											(keydown.enter)="dataStateChange()" />
										<button *ngIf="dataSearch.titleRecommendation" class="btn bg-transparent btn-clear-input"
											(click)="dataSearch.titleRecommendation=''">
											<i class="fa fa-times"></i>
										</button>
									</th>

									<th style="width: 150px">
										<p class="mb-1 d-flex justify-content-between align-items-center label-thead">
											<strong>Ngày tạo</strong>
										</p>
										<div class="dropdown bootstrap-select form-control form-control-sm ps-relative">
											<input class="form-control form-control-sm" placeholder="Chọn ngày" bsDatepicker #n="bsDatepicker"
												maxlength="10" [(ngModel)]="createdDate" appBsDatepickerInvalid
												(bsValueChange)="dateChange($event)"
												[bsConfig]="{dateInputFormat: 'DD/MM/YYYY', containerClass: 'theme-dark-blue', adaptivePosition: true}" />
											<div class="input-group-addon ps-absolute" style="top: 5px; right: 10px;">
												<i class="far fa-calendar-alt" (click)="n.toggle()" [attr.aria-expanded]="n.isOpen"></i>
											</div>
										</div>
									</th>
									<th style="width: 140px">
										<p class="mb-1 d-flex justify-content-between align-items-center label-thead">
											<strong>Trạng thái</strong>

										</p>
										<div class="dropdown bootstrap-select form-control form-control-sm">
											<ng-select class="" [items]="listStatus" placeholder="Trạng thái .." bindLabel="text"
												bindValue="value" notFoundText="Không có dữ liệu" [(ngModel)]="isPublish" [closeOnSelect]="true"
												(change)="dataStateChange()">
											</ng-select>
										</div>

									</th>
									<th style="width: 90px">
										<p class="mb-1 d-flex justify-content-between align-items-center label-thead"><strong>Thao
												tác</strong></p>
									</th>
								</tr>
							</ng-template>
							<ng-template pTemplate="body" let-rowNode let-rowData="rowData" let-rowIndex="rowIndex">
								<tr>
									<td class="text-center">{{ rowData.index }}</td>
									<td class="text-left">
										<p-treeTableToggler *ngIf="rowData.existChild" [rowNode]="rowNode"></p-treeTableToggler>
										<span *ngIf="!rowData.existChild" [style.marginLeft.px]="rowData.level * 10"
											style="margin-left:  'rowData.level' px;"></span>
										<span class="mb-0 font-weight-bold">
											<a routerLink="/quan-tri/kien-nghi/chi-tiet/{{rowData.recommendationId}}">{{ rowData.fullName
												}}</a>
										</span>
									</td>
									<td>
										<p class="mb-0 text-3line font-weight-bold">
											<a routerLink="/quan-tri/kien-nghi/chi-tiet/{{rowData.recommendationId}}">
												{{rowData.contents}}
											</a>
										</p>
									</td>
									<td>
										<p class="text-2line mb-0" title="{{rowData.contents}}">{{rowData.recommendationTitle}}</p>
									</td>
									<td>
										<p class="mb-0">{{ rowData.createdDate | date : 'dd/MM/yyyy HH:mm'}}</p>
									</td>
									<td>
										<span *ngIf="rowData.isPublish" (click)="preChangeStatus(rowData)" type="button"
											class="badge rounded-pill bg-success">Công bố</span>
										<span *ngIf="!rowData.isPublish" (click)="preChangeStatus(rowData)" type="button"
											class="badge rounded-pill badge-light">Không công bố</span>
									</td>
									<td>
										<a class="btn-icon grd-red text-white" (click)="preDelete(rowData.id)" title="Xóa"><i
												class="bi bi-trash"></i>
										</a>
									</td>
								</tr>
							</ng-template>
							<ng-template pTemplate="emptymessage">
								<tr>
									<td class="text-center" colspan="8">Không có dữ liệu</td>
								</tr>
							</ng-template>
							<ng-template pTemplate="paginatorright">
								<p class="mb-0">
									Tổng số {{totalRecords}} bản ghi
								</p>
							</ng-template>
						</p-treeTable>
					</div>
				</div>
			</div>
		</div>
	</div>

</div>

<div class="modal fade" id="modalConfirmDelete">
	<div class="modal-dialog modal-dialog-centered modal-md" style="min-width: 500px" role="document">
		<div class="modal-content rounded">
			<div class="modal-header border-bottom-0">
				<p class="modal-title h3">Xác nhận</p>
				<button type="button" class="close" data-dismiss="modal"><span>&times;</span>
				</button>
			</div>
			<div class="modal-body pb-3 pt-3">
				<span>
					Anh/Chị có chắc chắn muốn xóa bình luận này?
				</span>
			</div>
			<div class="modal-footer border-top-0">
				<button type="button" class="btn btn-outline-secondary btn-sm border w-127" data-dismiss="modal">Hủy</button>
				<button type="button" class="btn btn-danger border-0 w-127 grd-blue btn-sm" (click)="onDelete()">Xác
					nhận</button>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="modalConfirmChangeStatus">
	<div class="modal-dialog modal-dialog-centered modal-md" style="min-width: 500px" role="document">
		<div class="modal-content rounded">
			<div class="modal-header border-bottom-0">
				<p class="modal-title h3">Xác nhận</p>
				<button type="button" class="close" data-dismiss="modal"><span>&times;</span>
				</button>
			</div>
			<div class="modal-body pb-3 pt-3">
				<span>
					{{titleConfirm}}
				</span>
			</div>
			<div class="modal-footer border-top-0">
				<button type="button" class="btn btn-outline-secondary btn-sm border w-127" data-dismiss="modal">Hủy</button>
				<button type="button" class="btn btn-danger border-0 w-127 grd-blue btn-sm" (click)="onChangeStatus()">Xác
					nhận</button>
			</div>
		</div>
	</div>
</div>