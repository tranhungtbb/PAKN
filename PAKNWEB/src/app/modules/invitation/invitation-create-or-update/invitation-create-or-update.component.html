<div class="content-body">
	<div class="container-fluid p-0">
		<div class="row">
			<div class="col-lg-12">
				<ol class="breadcrumb title-module px-0 bg-transparent mb-0">
					<!-- <li class="breadcrumb-item"><a>Vai trò</a></li> -->
					<li class="breadcrumb-item active"><a class="font-weight-bold">{{title}}</a></li>
				</ol>
				<div class="btn-group group-button-table" role="group">
					<a class="btn btn-sm btn-default rounded mr-3" style="border: 1px solid gray;" [routerLink]="['/quan-tri/he-thong','vai-tro']">
						<i class="bi bi-arrow-left"></i>&nbsp;
						Quay lại
					</a>
					<button class="btn btn-sm grd-xanhngoc text-white rounded border-0 mr-3" (click)="onSave(false)">{{action}}</button>
					<button class="btn btn-sm grd-xanhngoc text-white rounded border-0 mr-3" (click)="onSave(true)">Gửi</button>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6" style="padding: 20px 20px 0px 40px; border-right: 1px solid #e5e5e5;">
				<form class="form-horizontal" [formGroup]="form">
					<div class="row form-group">
						<div class="col-sm-12 padding-col">
							<label class="control-label department">Tiêu đề<span class="text-danger">(*)</span></label>
							<input class="form-control" formControlName="title" [(ngModel)]="model.title" maxlength="100" placeholder="Nhập..." />
							<div *ngIf="(submitted && f.title.invalid) || (f.title.invalid && (f.title.dirty || f.title.touched))" class="has-error m-b-12">
								<div *ngIf="f.title.errors.required">
									<span class="help-block">Trường dữ liệu này không để trống</span>
								</div>
							</div>
						</div>

						<div class="col-sm-6 padding-col">
							<label class="control-label department">Thời gian bắt đầu<span class="text-danger">(*)</span></label>
							<div class="input-group">
								<input class="form-control" placeholder="Chọn ngày" bsDatepicker #n="bsDatepicker" maxlength="10" formControlName="startDate"
									[(ngModel)]="model.startDate" appBsDatepickerInvalid
									[bsConfig]="{dateInputFormat: 'DD/MM/YYYY', containerClass: 'theme-dark-blue', adaptivePosition: true}" />
								<div class="input-group-addon">
									<i class="far fa-calendar-alt" (click)="n.toggle()" [attr.aria-expanded]="n.isOpen"></i>
								</div>
							</div>
							<div *ngIf="(submitted && f.startDate.invalid) || (f.startDate.invalid && (f.startDate.dirty || f.startDate.touched))" class="has-error">
								<div *ngIf="f.startDate.errors.required">
									<span class="help-block">Trường dữ liệu này không được để trống</span>
								</div>
							</div>
						</div>
						<div class="col-sm-6 padding-col">
							<label class="control-label department">Thời gian kết thúc<span class="text-danger">(*)</span></label>
							<div class="input-group">
								<input class="form-control" placeholder="Chọn ngày" bsDatepicker #n="bsDatepicker" maxlength="10" formControlName="endDate"
									[(ngModel)]="model.endDate" appBsDatepickerInvalid [minDate]="model.startDate"
									[bsConfig]="{dateInputFormat: 'DD/MM/YYYY', containerClass: 'theme-dark-blue', adaptivePosition: true}" />
								<div class="input-group-addon">
									<i class="far fa-calendar-alt" (click)="n.toggle()" [attr.aria-expanded]="n.isOpen"></i>
								</div>
							</div>
							<div *ngIf="(submitted && f.endDate.invalid) || (f.endDate.invalid && (f.endDate.dirty || f.endDate.touched))" class="has-error">
								<div *ngIf="f.endDate.errors.required">
									<span class="help-block">Trường dữ liệu này không được để trống</span>
								</div>
							</div>
						</div>
						<div class="col-sm-12 padding-col">
							<label class="control-label department">Địa điểm <span class="text-danger">(*)</span></label>
							<input class="form-control" [(ngModel)]="model.place" formControlName="place" placeholder="Nhập..." />
							<div *ngIf="(submitted && f.place.invalid) || (f.place.invalid && (f.place.dirty || f.place.touched))" class="has-error m-b-12">
								<div *ngIf="f.place.errors">
									<span class="help-block">Trường dữ liệu này không để trống</span>
								</div>
							</div>
						</div>
						<div class="col-sm-12 padding-col">
							<label class="control-label department">Ghi chú</label>
							<input class="form-control" [(ngModel)]="model.note" formControlName="note" placeholder="Nhập..." />

						</div>
						<div class="col-sm-12 padding-col">
							<label class="control-label department">Nội dung <span class="text-danger">(*)</span></label>
							<textarea class="form-control" [(ngModel)]="model.content" formControlName="content" rows="5" placeholder="Nhập..."></textarea>
							<div *ngIf="(submitted && f.content.invalid) || (f.content.invalid && (f.content.dirty || f.content.touched))" class="has-error m-b-12">
								<div *ngIf="f.content.errors">
									<span class="help-block">Trường dữ liệu này không để trống</span>
								</div>
							</div>
						</div>
						<!-- tài liệu đính kèm -->
						<div class="col-12 attach-ct mt-3">
							<p class="h5 text-uppercase mb-3">
								<span>
									<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-paperclip" viewBox="0 0 16 16">
										<path
											d="M4.5 3a2.5 2.5 0 0 1 5 0v9a1.5 1.5 0 0 1-3 0V5a.5.5 0 0 1 1 0v7a.5.5 0 0 0 1 0V3a1.5 1.5 0 1 0-3 0v9a2.5 2.5 0 0 0 5 0V5a.5.5 0 0 1 1 0v7a3.5 3.5 0 1 1-7 0V3z">
										</path>
									</svg>
								</span>
								Tài liệu đính kèm
							</p>
							<div class="attach-file row">
								<div class="col-2 mb-2">
									<div class="alert alert-dark d-flex align-items-center h-80">
										<input type="file" style="display: none" #file id="file" (change)="onUpload($event)" class="inputfile inputfile-4 d-none" multiple
											accept="{{fileAccept}}" />
										<label for="file-5" (click)="file.click()" style="padding: 0px">
											<figure style="background-color: transparent; padding-left: 10px;">
												<i class="bi bi-file-earmark-arrow-up" style="font-size: 40px;"></i>
											</figure>
											<span class="d-block text-center" style="font-size: 15px;">Tải lên</span>
										</label>
									</div>
								</div>
								<ng-container *ngFor="let item of files">

									<div class="col-2 mb-2" *ngIf="item.fileType == 1">
										<div class="alert alert-dark alert-dismissible fade show d-flex align-items-center h-90">
											<button type="button" (click)="onRemoveFile(item)" class="close" data-dismiss="alert" aria-label="Close"><span><i
														class="mdi mdi-close"></i></span>
											</button>
											<a href="#" class="d-block text-center">
												<img src="../../../../assets/dist/images/file-word.svg" style="width: 45px" alt="">
												<span class="mt-3 text-dark text-wrap text-2line">{{item.name}}</span>
											</a>
										</div>
									</div>

									<div class="col-2 mb-2" *ngIf="item.fileType == 3">
										<div class="alert alert-dark alert-dismissible fade show d-flex align-items-center h-90">
											<button type="button" (click)="onRemoveFile(item)" class="close" data-dismiss="alert" aria-label="Close"><span><i
														class="mdi mdi-close"></i></span>
											</button>
											<a href="#" class="d-block text-center">
												<img src="../../../../assets/dist/images/file-pdf.svg" style="width: 45px" alt="">
												<span class="mt-3 text-dark text-wrap text-2line">{{item.name}}</span>
											</a>
										</div>
									</div>

									<div class="col-2 mb-2" *ngIf="item.fileType == 4">
										<div class="alert alert-dark alert-dismissible fade show d-flex align-items-center h-90">
											<button type="button" (click)="onRemoveFile(item)" class="close" (click)="onRemoveFile(item)"><span><i class="mdi mdi-close"></i></span>
											</button>
											<a href="#" class="d-block text-center box-fileinput">
												<img src="../../../../assets/dist/images/file-image.svg" style="width: 45px" alt="">
												<span class="mt-3 text-dark text-wrap text-2line">{{item.name}}</span>
											</a>
										</div>
									</div>

									<div class="col-2 mb-2" *ngIf="item.fileType == 2">
										<div class="alert alert-dark alert-dismissible fade show d-flex align-items-center h-90">
											<button type="button" (click)="onRemoveFile(item)" class="close" data-dismiss="alert" aria-label="Close"><span><i
														class="mdi mdi-close"></i></span>
											</button>
											<a href="#" class="d-block text-center">
												<img src="../../../../assets/dist/images/file-excel.svg" style="width: 45px" alt="">
												<span class="mt-3 text-dark text-wrap text-2line">{{item.name}}</span>
											</a>
										</div>
									</div>
									<div class="col-2 mb-2" *ngIf="item.fileType == 6">
										<div class="alert alert-dark alert-dismissible fade show d-flex align-items-center h-90">
											<button type="button" (click)="onRemoveFile(item)" class="close" data-dismiss="alert" aria-label="Close"><span><i
														class="mdi mdi-close"></i></span>
											</button>
											<a href="#" class="d-block text-center">
												<img src="../../../../assets/dist/images/file-powerpoint.svg" style="width: 45px" alt="">
												<span class="mt-3 text-dark text-wrap text-2line">{{item.name}}</span>
											</a>
										</div>
									</div>
								</ng-container>
							</div>
						</div>

					</div>
				</form>
			</div>
			<div class="col-md-6">
				<form class="form-horizontal" [formGroup]="form">
					<div class="row form-group" style="padding-right: 10px;">
						<div class="col-sm-12" style="padding: 0px 12px;">
							<div class="title-user-map">Thành phần tham dự</div>
							<div class="search-user">
								<div class="department">Họ và tên</div>
								<div class="" style="display: flex;">
									<div class="input-serach" style="width: 50%;">
										<!-- <ng-select placeholder="Nhập..." class="form-control" [items]="listUserIsSystem" bindValue="value" bindLabel="text" formControlName="userId"
											[virtualScroll]="true" [(ngModel)]="userId">
											<ng-template ng-option-tmp let-item="item">
												<div title="{{item.userName}}">{{item.userName}}</div>
											</ng-template>
										</ng-select> -->

										<ng-select class="form-control" placeholder="Nhập..." [closeOnSelect]="true" formControlName="userId" [(ngModel)]="userId">
											<ng-option *ngFor="let nt of listUserIsSystem" [value]="nt.id">
												{{nt.userName}}
											</ng-option>
										</ng-select>

									</div>
									<div style="width: 40%; display: flex;" class="center">
										<div class="form-check" style="margin: 5px;">
											<input class="form-check-input" type="checkbox" [(ngModel)]="sendSMS" formControlName="sendSMS" id="sendSMS">
											<label class="form-check-label" for="sendSMS">
												Gửi SMS
											</label>
										</div>
										<div class="form-check" style="margin: 5px;">
											<input class="form-check-input" type="checkbox" [(ngModel)]="sendEmail" formControlName="sendEmail" id="sendMail">
											<label class="form-check-label" for="sendMail">
												Gửi mail
											</label>
										</div>
									</div>
									<div class="action padding-item center">
										<button type="button" style="width: 40px; height: 40px;" class="btn grd-blue btn-block border-0 px-3 text-white" (click)="onCreateUser()">
											<i class="bi bi-person-plus"></i>
										</button>
									</div>
								</div>
							</div>

						</div>


						<div class="list-user">
							<div class="title-user-map center" style="text-transform: none;" *ngIf="listItemUserSelected.length ==0">Chưa có thành phần tham dự</div>
							<div class="col-sm-12 item-user" *ngFor="let item of listItemUserSelected">
								<div class="info-user border-right padding-item" style="display: flex; padding-left: 0px;">
									<img style="width: 40px; height: 40px; object-fit: cover; border-radius: 4px; margin-right: 5px;"
										src="../../../../assets/dist/images/avatar/1.jpg" alt="">
									<div>
										<div class="title">{{item.fullName}}</div>
										<div class="department">{{item.positionName}}</div>
									</div>
								</div>
								<div class="info-unit border-right padding-item" style="width: 40%">
									<div class="title">Đơn vị</div>
									<div class="department">{{item.unitName}}</div>
								</div>
								<div class="type-send border-right padding-item">
									<div class="form-check">
										<input class="form-check-input" type="checkbox" [checked]="item.sendSMS == true" (click)="onUpdateUser(item.userId, true)">
										<label class="form-check-label">
											Gửi SMS
										</label>
									</div>
									<div class="form-check">
										<input class="form-check-input" type="checkbox" [checked]="item.sendEmail == true" (click)="onUpdateUser(item.userId, false)">
										<label class="form-check-label">
											Gửi mail
										</label>
									</div>
								</div>
								<div class="action padding-item center">
									<button type="button" style="width: 40px; height: 40px;" class="btn grd-blue btn-block border-0 px-3 text-white" (click)="onRemoveUser(item)">
										<i class="bi bi-person-dash"></i>
									</button>
								</div>
							</div>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>
